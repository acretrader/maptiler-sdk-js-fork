{"version":3,"file":"maptiler.mjs","sources":["../src/LngLat.ts","../src/config.ts","../src/defaults.ts","../src/tools.ts","../src/Map.ts"],"sourcesContent":["import * as maplibre from 'maplibre-gl'\n\nexport default class  LngLat extends maplibre.LngLat {\n  constructor(lng: number, lat: number) {\n    super(lng, lat);\n  }\n\n  setToNull(): void {\n    this.lng = 0;\n    this.lat = 0;\n  }\n}","interface ConfigInterface {\n  apiToken: string,\n  verbose: boolean,\n}\n\nconst config: ConfigInterface = {\n  apiToken: 'Not defined yet.',\n  verbose: false,\n}\n\nexport { config };","\n/**\n * Some default settings for the SDK\n */\nconst defaults = {\n  // When a Map is instanciated without a 'style', then this one is the default\n  mapStyle: \"streets\"\n};\n\nexport default defaults;","import { config } from \"./config\";\n\n/**\n * Prints on console only if 'verbose' mode from the config is set to true\n * @param args \n */\nexport function vlog(...args: any[]) {\n  if (config.verbose) {\n    console.log(...arguments);\n  }\n}\n\n\n/**\n * Expand the map style provided as argument of the Map constructor\n * @param style \n * @returns \n */\nexport function expandMapStyle(style): string {\n  const trimmed = style.trim();\n\n  // The style was possibly already given as expanded URL\n  if (trimmed.startsWith(\"http://\") || trimmed.startsWith(\"https://\")) {\n    return trimmed;\n  }\n\n  // testing if the style provided is of form \"maptiler://some-style\"\n  const maptilerDomainRegex = /^maptiler:\\/\\/(.*)/;\n  const match = maptilerDomainRegex.exec(trimmed);\n  \n  if (match) {\n    return `https://api.maptiler.com/maps/${match[1]}/style.json`\n  } \n\n  // The style could also possibly just be the name of the style without any URI style\n  return `https://api.maptiler.com/maps/${trimmed}/style.json`\n}","import * as maplibre from 'maplibre-gl';\nimport { config } from './config';\nimport defaults from './defaults';\nimport { expandMapStyle, vlog } from './tools';\n\n\ntype MapOptions = Omit<maplibre.MapOptions, \"style\"> & {\n  style?: string\n}\n\n\n/**\n * Map constructor\n */\nexport default class  Map extends maplibre.Map {\n  constructor(options: MapOptions) { \n    let style = expandMapStyle(defaults.mapStyle);\n\n    if (\"style\" in options) {\n      style = expandMapStyle(options.style as string);\n    } else {\n      vlog(`Map style not provided, backing up to ${defaults.mapStyle}`);\n    }\n\n    // appending the token if necessary\n    if (!style.includes('key=')) {\n      style = `${style}?key=${config.apiToken}`\n    }\n\n    // calling the map constructor with full length style\n    super({...options, style });    \n  }\n}"],"names":[],"mappings":";;;AAEsB,MAAA,MAAA,SAAe,SAAS,MAAO,CAAA;AAAA,EACnD,WAAA,CAAY,KAAa,GAAa,EAAA;AACpC,IAAA,KAAA,CAAM,KAAK,GAAG,CAAA,CAAA;AAAA,GAChB;AAAA,EAEA,SAAkB,GAAA;AAChB,IAAA,IAAA,CAAK,GAAM,GAAA,CAAA,CAAA;AACX,IAAA,IAAA,CAAK,GAAM,GAAA,CAAA,CAAA;AAAA,GACb;AACF;;ACNA,MAAM,MAA0B,GAAA;AAAA,EAC9B,QAAU,EAAA,kBAAA;AAAA,EACV,OAAS,EAAA,KAAA;AACX;;ACJA,MAAM,QAAW,GAAA;AAAA,EAEf,QAAU,EAAA,SAAA;AACZ,CAAA;;ACDO,SAAS,QAAQ,IAAa,EAAA;AACnC,EAAA,IAAI,OAAO,OAAS,EAAA;AAClB,IAAQ,OAAA,CAAA,GAAA,CAAI,GAAG,SAAS,CAAA,CAAA;AAAA,GAC1B;AACF,CAAA;AAQO,SAAS,eAAe,KAAe,EAAA;AAC5C,EAAM,MAAA,OAAA,GAAU,MAAM,IAAK,EAAA,CAAA;AAG3B,EAAA,IAAI,QAAQ,UAAW,CAAA,SAAS,KAAK,OAAQ,CAAA,UAAA,CAAW,UAAU,CAAG,EAAA;AACnE,IAAO,OAAA,OAAA,CAAA;AAAA,GACT;AAGA,EAAA,MAAM,mBAAsB,GAAA,oBAAA,CAAA;AAC5B,EAAM,MAAA,KAAA,GAAQ,mBAAoB,CAAA,IAAA,CAAK,OAAO,CAAA,CAAA;AAE9C,EAAA,IAAI,KAAO,EAAA;AACT,IAAA,OAAO,iCAAiC,KAAM,CAAA,CAAA,CAAA,CAAA,WAAA,CAAA,CAAA;AAAA,GAChD;AAGA,EAAA,OAAO,CAAiC,8BAAA,EAAA,OAAA,CAAA,WAAA,CAAA,CAAA;AAC1C;;;;;;;;;;;;;;;;;;;;;ACtBsB,MAAA,GAAA,SAAY,SAAS,GAAI,CAAA;AAAA,EAC7C,YAAY,OAAqB,EAAA;AAC/B,IAAI,IAAA,KAAA,GAAQ,cAAe,CAAA,QAAA,CAAS,QAAQ,CAAA,CAAA;AAE5C,IAAA,IAAI,WAAW,OAAS,EAAA;AACtB,MAAQ,KAAA,GAAA,cAAA,CAAe,QAAQ,KAAe,CAAA,CAAA;AAAA,KACzC,MAAA;AACL,MAAK,IAAA,CAAA,CAAA,sCAAA,EAAyC,SAAS,QAAU,CAAA,CAAA,CAAA,CAAA;AAAA,KACnE;AAGA,IAAA,IAAI,CAAC,KAAA,CAAM,QAAS,CAAA,MAAM,CAAG,EAAA;AAC3B,MAAQ,KAAA,GAAA,CAAA,EAAG,aAAa,MAAO,CAAA,QAAA,CAAA,CAAA,CAAA;AAAA,KACjC;AAGA,IAAA,KAAA,CAAM,aAAI,CAAA,cAAA,CAAA,EAAA,EAAA,OAAA,CAAA,EAAJ,EAAa,KAAA,EAAO,CAAA,CAAA,CAAA;AAAA,GAC5B;AACF;;;;"}